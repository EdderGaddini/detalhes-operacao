<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Total Express / Romaneio Eletrônico</title>
  <!-- Favicon: logo da página -->
  <link rel="icon" href="icons/logo-site.png" type="image/png">
  <!-- Link para o arquivo CSS externo -->
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container">
    <h1>Romaneio Eletrônico</h1>
    <table>
      <thead>
        <tr>
          <th>Parâmetro</th>
          <th>Valor</th>
        </tr>
      </thead>
      <tbody id="paramTable">
        <!-- As linhas serão inseridas via JavaScript -->
      </tbody>
    </table>

    <!-- Footer integrado no card -->
    <div class="footer">
      <div class="logo">
        <a href="https://www.totalexpress.com.br/" target="_blank">
          <img src="icons/logo-total-express-slogan.svg" alt="Logo" class="logo-img">
        </a>
      </div>
      <div class="social-buttons">
        <!-- Botão para o site (LinkedIn, por exemplo) -->
        <a href="https://www.linkedin.com/company/totalexpress/" target="_blank">
          <img src="icons/linkedin.png" alt="Site">
        </a>
        <!-- Botão para o Instagram -->
        <a href="https://www.instagram.com/totalexpressbrasil/" target="_blank">
          <img src="icons/instagram.png" alt="Instagram">
        </a>
        <!-- Botão para o YouTube -->
        <a href="https://www.youtube.com/channel/UCko_yFUb7Q1I87Ns4-UpH-A" target="_blank">
          <img src="icons/youtube.png" alt="YouTube">
        </a>
        <!-- Botão para o WhatsApp -->
        <a href="https://api.whatsapp.com/send?phone=551136275900&amp%3Btext=Envie%20uma%20mensagem" target="_blank">
          <img src="icons/whatsapp.png" alt="WhatsApp">
        </a>
      </div>
    </div>
  </div>

  <script>
    // Função para extrair e decodificar o parâmetro "data"
    function getDecodedData() {
      const params = new URLSearchParams(window.location.search);

      // Pega o valor do parâmetro "data"
      const dataParam = params.get('data');
      if (!dataParam) {
        return null; // Se não existir 'data', retorna null
      }

      try {
        // Decodifica em Base64 (versão URL-safe)
        // 1) Precisamos transformar a base64Url de volta para base64 normal 
        //    (onde '-' -> '+' e '_' -> '/')
        let base64 = dataParam
          .replace(/-/g, '+')
          .replace(/_/g, '/');

        // 2) Faz atob para decodificar base64 (Browser JS)
        const jsonString = atob(base64);

        // 3) Faz o parse da string JSON
        const decodedObject = JSON.parse(jsonString);

        return decodedObject;
      } catch (e) {
        console.error("Erro ao decodificar/parsing JSON:", e);
        return null;
      }
    }

    // Função para renderizar os dados na tabela
    function renderTable() {
      const tbody = document.getElementById('paramTable');

      // Obtem o objeto decodificado
      const dataObject = getDecodedData();

      // Se não achar nada, mostrar mensagem
      if (!dataObject) {
        tbody.innerHTML = '<tr><td colspan="2" style="text-align: center;">Nenhum dado encontrado.</td></tr>';
        return;
      }

      // Monta as linhas com base nas chaves do objeto
      const keys = Object.keys(dataObject);

      // Se não houver chaves no objeto, mostra mensagem
      if (keys.length === 0) {
        tbody.innerHTML = '<tr><td colspan="2" style="text-align: center;">Nenhum dado encontrado.</td></tr>';
        return;
      }

      // Cria cada linha da tabela
      keys.forEach(key => {
        const row = document.createElement('tr');

        const cellKey = document.createElement('td');
        cellKey.textContent = key;

        const cellValue = document.createElement('td');
        cellValue.textContent = dataObject[key];

        row.appendChild(cellKey);
        row.appendChild(cellValue);
        tbody.appendChild(row);
      });
    }

    // Chama a função de renderizar assim que a página carrega
    renderTable();
  </script>
</body>

</html>